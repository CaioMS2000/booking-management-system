┌─────────────────────────────────────────────────────────────────┐
│                         CAMADA EXTERNA                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐       │
│  │  Web App │  │ Mobile   │  │  Tablet  │  │  Admin   │       │
│  │ (React)  │  │(React N.)│  │  App     │  │  Panel   │       │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘       │
│       │             │             │             │               │
└───────┼─────────────┼─────────────┼─────────────┼───────────────┘
        │             │             │             │
        └─────────────┴─────────────┴─────────────┘
                      │
┌─────────────────────┼─────────────────────────────────────────┐
│                CAMADA DE EDGE/GATEWAY                          │
├─────────────────────┼─────────────────────────────────────────┤
│                     ↓                                          │
│            ┌─────────────────┐                                 │
│            │  CDN (Cloudflare│                                 │
│            │    ou AWS CF)   │                                 │
│            └────────┬────────┘                                 │
│                     ↓                                          │
│            ┌─────────────────┐                                 │
│            │  WAF (Web App   │                                 │
│            │   Firewall)     │                                 │
│            └────────┬────────┘                                 │
│                     ↓                                          │
│            ┌─────────────────┐                                 │
│            │  Load Balancer  │                                 │
│            │   (AWS ALB/     │                                 │
│            │    Nginx)       │                                 │
│            └────────┬────────┘                                 │
└─────────────────────┼─────────────────────────────────────────┘
                      │
┌─────────────────────┼─────────────────────────────────────────┐
│              CAMADA DE API GATEWAY                             │
├─────────────────────┼─────────────────────────────────────────┤
│                     ↓                                          │
│       ┌──────────────────────────────┐                         │
│       │    API Gateway (Kong)        │                         │
│       │                              │                         │
│       │ • JWT Validation             │                         │
│       │ • Rate Limiting (Global)     │                         │
│       │ • Request/Response Transform │                         │
│       │ • API Versioning (/v1, /v2)  │                         │
│       │ • CORS                       │                         │
│       │ • Circuit Breaker            │                         │
│       │ • Metrics Collection         │                         │
│       └──────────┬───────────────────┘                         │
└──────────────────┼─────────────────────────────────────────────┘
                   │
┌──────────────────┼─────────────────────────────────────────────┐
│              CAMADA DE BFF (OPCIONAL)                          │
├──────────────────┼─────────────────────────────────────────────┤
│                  │                                             │
│    ┌─────────────┼──────────────┐                              │
│    │             │              │                              │
│    ↓             ↓              ↓                              │
│ ┌────────┐  ┌────────┐  ┌──────────┐                          │
│ │BFF Web │  │BFF Mob.│  │BFF Admin │                          │
│ │(Node)  │  │(Node)  │  │(Node)    │                          │
│ └───┬────┘  └───┬────┘  └────┬─────┘                          │
└─────┼──────────┼──────────────┼─────────────────────────────────┘
      │          │              │
      └──────────┴──────────────┘
                 │
┌────────────────┼─────────────────────────────────────────────┐
│          CAMADA DE MICROSERVIÇOS                              │
├────────────────┼─────────────────────────────────────────────┤
│                │                                              │
│    ┌───────────┼───────────────┐                              │
│    │           │               │                              │
│    ↓           ↓               ↓                              │
│ ┌──────────────────────────────────────────────┐              │
│ │  MS1: Reservas & Disponibilidade             │              │
│ │  (NestJS + TypeScript)                       │              │
│ │  ┌──────────┐  ┌──────────┐  ┌──────────┐   │              │
│ │  │Instance 1│  │Instance 2│  │Instance 3│   │              │
│ │  └──────────┘  └──────────┘  └──────────┘   │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ PostgreSQL (Primary + Replicas)      │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ Redis Cluster (Cache + Sessions)     │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ └──────────────────────────────────────────────┘              │
│                                                               │
│ ┌──────────────────────────────────────────────┐              │
│ │  MS2: Pagamentos & Cobranças                 │              │
│ │  (NestJS + TypeScript)                       │              │
│ │  ┌──────────┐  ┌──────────┐                  │              │
│ │  │Instance 1│  │Instance 2│                  │              │
│ │  └──────────┘  └──────────┘                  │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ PostgreSQL (Primary + Replicas)      │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ Redis Cluster                        │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ └──────────────────────────────────────────────┘              │
│                                                               │
│ ┌──────────────────────────────────────────────┐              │
│ │  MS3: Notificações                           │              │
│ │  (NestJS + TypeScript)                       │              │
│ │  • Email (SendGrid)                          │              │
│ │  • SMS (Twilio)                              │              │
│ │  • Push Notifications (Firebase)             │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ MongoDB (Histórico de notificações)  │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ └──────────────────────────────────────────────┘              │
│                                                               │
│ ┌──────────────────────────────────────────────┐              │
│ │  MS4: Gestão de Usuários & Auth              │              │
│ │  (NestJS + TypeScript)                       │              │
│ │  • JWT Generation                            │              │
│ │  • OAuth2 (Google, Facebook)                 │              │
│ │  • MFA (Two-Factor Auth)                     │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ PostgreSQL                           │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ │  ┌──────────────────────────────────────┐   │              │
│ │  │ Redis (Sessions, Refresh Tokens)     │   │              │
│ │  └──────────────────────────────────────┘   │              │
│ └──────────────────────────────────────────────┘              │
└───────────────────────────────────────────────────────────────┘
                        │
┌───────────────────────┼───────────────────────────────────────┐
│            CAMADA DE MENSAGERIA & EVENTOS                     │
├───────────────────────┼───────────────────────────────────────┤
│                       ↓                                       │
│          ┌─────────────────────────┐                          │
│          │  Event Bus (RabbitMQ)   │                          │
│          │  ou Kafka               │                          │
│          │                         │                          │
│          │  Topics/Queues:         │                          │
│          │  • reserva.criada       │                          │
│          │  • reserva.confirmada   │                          │
│          │  • reserva.cancelada    │                          │
│          │  • pagamento.aprovado   │                          │
│          │  • pagamento.recusado   │                          │
│          │  • notificacao.enviada  │                          │
│          └─────────────────────────┘                          │
└───────────────────────────────────────────────────────────────┘
                        │
┌───────────────────────┼───────────────────────────────────────┐
│         CAMADA DE OBSERVABILIDADE                             │
├───────────────────────┼───────────────────────────────────────┤
│                       │                                       │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │ Prometheus   │  │   Grafana    │  │    Jaeger    │         │
│  │  (Metrics)   │  │ (Dashboards) │  │  (Tracing)   │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                               │
│  ┌──────────────────────────────────────────────────┐         │
│  │  ELK Stack (Elasticsearch, Logstash, Kibana)     │         │
│  │  ou Loki + Promtail                              │         │
│  │  (Logs Centralizados)                            │         │
│  └──────────────────────────────────────────────────┘         │
│                                                               │
│  ┌──────────────────────────────────────────────────┐         │
│  │  Sentry (Error Tracking & Performance)           │         │
│  └──────────────────────────────────────────────────┘         │
└───────────────────────────────────────────────────────────────┘
                        │
┌───────────────────────┼───────────────────────────────────────┐
│         CAMADA DE SEGURANÇA & COMPLIANCE                      │
├───────────────────────┼───────────────────────────────────────┤
│                                                               │
│  • HashiCorp Vault (Secrets Management)                       │
│  • AWS Secrets Manager / Azure Key Vault                      │
│  • Certificados SSL/TLS (Let's Encrypt)                       │
│  • LGPD Compliance (Data Privacy)                             │
│  • PCI DSS (Payment Card Industry)                            │
│  • Backup automatizado (Daily + Point-in-time recovery)       │
└───────────────────────────────────────────────────────────────┘